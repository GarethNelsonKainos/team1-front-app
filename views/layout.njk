<!DOCTYPE html>
<html lang="en">
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/styles.css">
</head>
<body class="bg-gray-100 flex flex-col min-h-screen">
    <header class="bg-white p-4 flex justify-between items-center">
        <a href="/login">
            <img src="/KainosLogo.png" alt="Kainos" class="logo" style="height: 50px; width: auto;">
        </a>
        
        <!-- Navigation Bar -->
        <nav class="flex-1 mx-8">
            <ul class="flex gap-6">
                <li>
                    <a href="/job-roles" class="nav-link px-3 py-2 rounded hover:bg-gray-100 transition-colors" style="color: var(--brand-primary);">
                        Current Vacancies
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Sign In/Out button container -->
        <div id="authContainer">
            <!-- Sign In button (shown when not logged in) -->
            <a href="/login" id="signInButton" class="sign-in-button flex items-center gap-2 px-4 py-2 bg-white rounded hover:bg-gray-100 border" style="color: var(--brand-primary); border-color: var(--brand-primary);">
                <img src="/SignInIcon.png" alt="" class="sign-in-icon" style="height: 25px;">
                <span>Sign In</span>
            </a>
            
            <!-- User menu (shown when logged in) -->
            <div id="userMenu" class="hidden flex items-center gap-4">
                <span id="userEmail" class="text-sm" style="color: var(--brand-primary);"></span>
                <button id="signOutButton" class="sign-out-button px-4 py-2 bg-white rounded hover:bg-gray-100 border" style="color: var(--brand-primary); border-color: var(--brand-primary);">
                    Sign Out
                </button>
            </div>
        </div>
    </header>

    <main class="container mx-auto p-4 flex-grow mt-8 mb-8">
        {% block content %}{% endblock %}
    </main>

    <footer class="bg-gray-800 text-white p-8 mt-auto">
        <div class="container mx-auto flex justify-between items-start gap-8">
            <div class="footer-logo">
                <img src="/KainosLogo.png" alt="Kainos" style="height: 50px; width: auto; filter: brightness(0) invert(1);">
            </div>
            <div class="footer-contact">
                <h3 class="font-bold mb-2">Contact Us</h3>
                <p>Email: info@kainos.com</p>
                <p>Phone: +44 (0)28 9057 1100</p>
            </div>
            <div class="footer-address">
                <h3 class="font-bold mb-2">Address</h3>
                <p>Kainos House</p>
                <p>4-6 Upper Crescent</p>
                <p>Belfast</p>
                <p>BT7 1NT</p>
                <p>Northern Ireland</p>
            </div>
        </div>
        <div class="text-center mt-8 border-t border-gray-700 pt-4">
            <p>&copy; <span id="currentYear"></span> Kainos. All rights reserved.</p>
        </div>
        </div>
    </footer>

    <script>
        // Set current year
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Authentication state management
        document.addEventListener('DOMContentLoaded', function() {
            const signInButton = document.getElementById('signInButton');
            const userMenu = document.getElementById('userMenu');
            const userEmail = document.getElementById('userEmail');
            const signOutButton = document.getElementById('signOutButton');

            // Check authentication status
            function checkAuthStatus() {
                const token = sessionStorage.getItem('authToken');
                const email = sessionStorage.getItem('userEmail');

                if (token && email) {
                    // User is logged in
                    signInButton.classList.add('hidden');
                    userMenu.classList.remove('hidden');
                    userEmail.textContent = email;
                } else {
                    // User is not logged in
                    signInButton.classList.remove('hidden');
                    userMenu.classList.add('hidden');
                }
            }

            // Sign out handler
            function signOut() {
                // Clear authentication data
                sessionStorage.removeItem('authToken');
                sessionStorage.removeItem('userEmail');
                
                // Update UI
                checkAuthStatus();
                
                // Redirect to home page
                window.location.href = '/';
            }

            // Add click handler for sign out button
            if (signOutButton) {
                signOutButton.addEventListener('click', signOut);
            }

            // Check auth status on page load
            checkAuthStatus();

            // Listen for auth changes (for when login happens in another tab)
            window.addEventListener('storage', function(e) {
                if (e.key === 'authToken' || e.key === 'userEmail') {
                    checkAuthStatus();
                }
            });
        });
    </script>
</body>
</html>